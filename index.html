<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    
    一只程序猪</title>
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  
    <link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">
  
  <script src="/js/pace.min.js"></script>
</head>
</html>
<body>
<main class="content">
  <section class="jumbotron">
  <div class="video">
    
      <div class="video-frame">
        <img src="/images/ocean/overlay-hero.png" alt="Decorative image frame">
      </div>
    
    <div class="video-media">
      <video playsinline="" autoplay loop muted data-autoplay="" poster="/images/ocean/ocean.png" x5-video-player-type="h5">
        <source src="/images/ocean/ocean.mp4" type="video/mp4">
        <source src="/images/ocean/ocean.ogv" type="video/ogg">
        <source src="/images/ocean/ocean.webm" type="video/webm">
        <p>Your user agent does not support the HTML5 Video element.</p>
      </video>
      <div class="video-overlay"></div>
    </div>
    <div class="video-inner text-center text-white">
      <h1><a href="/">一只程序猪</a></h1>
      <p>爱生活 | 爱二梦 | 爱编程</p>
      <div><img src="/images/pig-white.png" class="brand" alt="一只程序猪"></div>
    </div>
    <div class="video-learn-more">
      <a class="anchor" href="#landingpage"><i class="fe fe-mouse"></i></a>
    </div>
  </div>
</section>

<div id="landingpage">
  <section class="outer">
  <article class="articles">
    
    <h1 class="page-type-title"></h1>

    
      
        <article id="post-react-native开发碰到的问题及插件整理" class="article article-type-post" itemscope="" itemprop="blogPost">

  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 itemprop="name">
      <a class="article-title" href="/2019/02/19/react-native开发碰到的问题及插件整理/">react-native开发碰到的问题及插件整理</a>
    </h2>
  

      </header>
    

    
      <div class="article-meta">
        <a href="/2019/02/19/react-native开发碰到的问题及插件整理/" class="article-date">
  <time datetime="2019-02-19T06:58:24.000Z" itemprop="datePublished">2019-02-19</time>
</a>
        
      </div>
    

    <div class="article-entry" itemprop="articleBody">
      
      
      
        <h4 id="1-uncompiled-PNG-file"><a href="#1-uncompiled-PNG-file" class="headerlink" title="1. uncompiled PNG file"></a>1. uncompiled PNG file</h4><p>描述：该问题出现在打包成release apk的时候<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/Users/almouro/bam/uefa/TestGradle3/android/app/build/intermediates/res/merged/release/drawable-mdpi/image.png: error: uncompiled PNG file passed as argument. Must be compiled first into .flat file..</span><br><span class="line">error: failed parsing overlays.</span><br></pre></td></tr></table></figure></p>
<p>解决方法：<br>打开 <code>android/gradle.properties</code> 文件添加 <code>android.enableAapt2=false</code> </p>
<p>查看: <a href="https://github.com/facebook/react-native/issues/16906" target="_blank" rel="noopener">github issues uncompiled PNG file</a></p>
<h4 id="2-react-native-modal-组件"><a href="#2-react-native-modal-组件" class="headerlink" title="2. react-native modal 组件"></a>2. react-native modal 组件</h4><p>描述： 在使用react-native modal 组件的时候发现模态框并没有覆盖到手机状态栏</p>
<p>解决方法：<a href="https://github.com/listenzz/react-native-modal-translucent" target="_blank" rel="noopener">react-native-modal-translucent</a></p>
<h4 id="3-react-native-键盘弹出导致绝对定位元素上浮"><a href="#3-react-native-键盘弹出导致绝对定位元素上浮" class="headerlink" title="3. react-native 键盘弹出导致绝对定位元素上浮"></a>3. react-native 键盘弹出导致绝对定位元素上浮</h4><p>描述：当软键盘通过textInput组件唤起的时候，绝对定位元素上浮</p>
<p>解决方法：打开<code>AndroidManifest.xml</code>文件修改<code>activity</code> 中的 <code>android:windowSoftinputMode=&quot;stateAlwaysHidden|adjustpan&quot;</code></p>
<p>参考连接：<a href="https://394498036.iteye.com/blog/2393507" target="_blank" rel="noopener">原文</a></p>
<p>windowSoftinputMode介绍：<a href="https://developer.android.com/guide/topics/manifest/activity-element" target="_blank" rel="noopener">Developers</a></p>
<h4 id="4-react-native-软键盘遮住textInput"><a href="#4-react-native-软键盘遮住textInput" class="headerlink" title="4. react-native 软键盘遮住textInput"></a>4. react-native 软键盘遮住textInput</h4><p>描述：当页面有多个 textInput 输入框，底部输入框唤起软键盘时会被遮住</p>
<p>解决方法：<a href="https://github.com/APSL/react-native-keyboard-aware-scroll-view" target="_blank" rel="noopener">react-native-keyboard-aware-scroll-view</a></p>
<p>使用方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import &#123; KeyboardAwareScrollView &#125; from &apos;react-native-keyboard-aware-scroll-view&apos;</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">&lt;KeyboardAwareScrollView&gt;</span><br><span class="line">  &lt;View&gt;</span><br><span class="line">    &lt;TextInput /&gt;</span><br><span class="line">    &lt;TextInput /&gt;</span><br><span class="line">    &lt;TextInput /&gt;</span><br><span class="line">  &lt;/View&gt;</span><br><span class="line">&lt;/KeyboardAwareScrollView&gt;</span><br><span class="line">...</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h4 id="5-react-native-蓝牙通信"><a href="#5-react-native-蓝牙通信" class="headerlink" title="5. react-native 蓝牙通信"></a>5. react-native 蓝牙通信</h4><p>描述：蓝牙分两种通信模式(BEL蓝牙 和 经典蓝牙)，对于BLE蓝牙推荐使用react-native-ble-manager 组件，对于经典蓝牙推荐使用react-native-bluetooth-serial</p>
<p>解决方法：</p>
<p>BLE蓝牙：<a href="https://github.com/innoveit/react-native-ble-manager" target="_blank" rel="noopener">react-native-ble-manager</a></p>
<p>经典蓝牙: <a href="https://github.com/rusel1989/react-native-bluetooth-serial" target="_blank" rel="noopener">react-native-bluetooth-serial</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/02/19/react-native开发碰到的问题及插件整理/" data-id="cjsbfju6400027ca241rya3rt" class="article-share-link">Share</a>
      
    </footer>

  </div>

  

  

</article>



      
        <article id="post-setMonth问题" class="article article-type-post" itemscope="" itemprop="blogPost">

  <div class="article-inner">
    

    
      <div class="article-meta">
        <a href="/2019/02/12/setMonth问题/" class="article-date">
  <time datetime="2019-02-12T09:36:14.612Z" itemprop="datePublished">2019-02-12</time>
</a>
        
      </div>
    

    <div class="article-entry" itemprop="articleBody">
      
      
      
        <h1 id="setMonth导致获取月份错误"><a href="#setMonth导致获取月份错误" class="headerlink" title="setMonth导致获取月份错误"></a>setMonth导致获取月份错误</h1><ol>
<li>问题重现</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> // 比如今天是 2017-03-31 号，理论上后推一个月应该是4月   </span><br><span class="line">let now = new Date(new Date(&quot;2017-03-31&quot;).setMonth(new Date(&quot;2017-03-31&quot;).getMonth() + 1))</span><br><span class="line">console.log(&apos;now :&apos;, now.getMonth())</span><br><span class="line">// 结果是：now : 2017/5/1 上午8:00:00</span><br></pre></td></tr></table></figure>
<pre><code>实际的结果和预想的结果不一致！！
</code></pre><p><strong>MDN解释：</strong></p>
<blockquote>
<p>If you do not specify the dayValue parameter, the value returned from the getDate() method is used.<br><br><br>If a parameter you specify is outside of the expected range, setMonth() attempts to update the date information in the Date object accordingly. For example, if you use 15 for monthValue, the year will be incremented by 1, and 3 will be used for month.<br><br><br>The current day of month will have an impact on the behaviour of this method. Conceptually it will add the number of days given by the current day of the month to the 1st day of the new month specified as the parameter, to return the new date. For example, if the current value is 31st August 2016, calling setMonth with a value of 1 will return 2nd March 2016. This is because in 2016 February had 29 days.</p>
</blockquote>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/setMonth" target="_blank" rel="noopener">查看MDN解释</a></p>
<p>简单来说就是：对当前的日期调用setMonth操作时，如果当前月份的天数大于新的月份天数，那么日期会依次向后推。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let now = new Date(new Date(&quot;2017-03-31&quot;).setMonth(new Date(&quot;2017-03-31&quot;).getMonth() + 1))</span><br><span class="line">console.log(&apos;now :&apos;, now.toLocaleString())</span><br><span class="line">// now : 2017/5/1 上午8:00:00</span><br><span class="line">// 2017-03-31 该月份有31天，当调用getMonth() + 1时</span><br><span class="line">// 理论上会加上当前月份的最大值31</span><br><span class="line">// 这时计算之后的日期是2017-04-31</span><br><span class="line">// 但是4月只有30天，所以后推一天变成2017-05-01,所以月份变成了5月</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>解决方法</li>
</ol>
<ul>
<li>setMonth之前先setDate(1)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function getNextMonth(date) &#123;</span><br><span class="line">    const now = new Date(date);</span><br><span class="line">    now.setDate(1);</span><br><span class="line">    now.setMonth(now.getMonth() + 1);</span><br><span class="line">    return now.getMonth() + 1;</span><br><span class="line">&#125;</span><br><span class="line">console.log(getNextMonth(&quot;2017-03-31&quot;))</span><br><span class="line">// 4  结果正确</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/02/12/setMonth问题/" data-id="cjsbfju6000007ca23jj1wx96" class="article-share-link">Share</a>
      
    </footer>

  </div>

  

  

</article>



      
  </article>
  
  
</section>
</div>

  <footer class="footer">
  
  <div class="outer">
    <ul class="list-inline">
      <li>&copy; 2019 一只程序猪</li>
      <li>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li>
      <li>Theme  <a href="https://zhwangart.github.io">zhwangart</a></li>
      <!--
      <li><a href="/">arvin</a></li>
      -->
    </ul>
  </div>
</footer>
</main>
<aside class="sidebar">
  <button class="navbar-toggle"></button>

<nav class="navbar">
  
    <div class="logo">
      <a href="/"><img src="/images/pig.png" alt="一只程序猪"></a>
    </div>
  
  <ul class="nav nav-main">
    
      <li class="nav-item">
        <a class="nav-item-link" href="/">主页</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/archives">归档</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/gallery">相册</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/about">关于</a>
      </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="Search">
        <i class="fe fe-search"></i>
        搜索
      </a>
    </li>
  </ul>
</nav>

<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
        <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
          <i class="fe fe-feed"></i>
        </a>
      
    </li>
  </ul>
</nav>

<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
</aside>
  <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/lazyload.min.js"></script>


  <script src="/fancybox/jquery.fancybox.min.js"></script>



  <script src="/js/search.js"></script>


<script src="/js/ocean.js"></script>

<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>